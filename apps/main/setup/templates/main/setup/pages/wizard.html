{% extends "base.html" %}
{% load static %}
{% load i18n %}

{% block title %}ERPlora Hub - {% trans "Setup" %}{% endblock %}

{% block extra_css %}
<style>
    .setup-container {
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 1rem;
    }

    .setup-card {
        width: 100%;
        max-width: 600px;
        margin: 0;
    }

    .section-title {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        margin: 1.5rem 0 1rem 0;
        font-size: 1.1rem;
        font-weight: 600;
        color: var(--ion-color-primary);
    }

    .section-title:first-child {
        margin-top: 0;
    }
</style>
{% endblock %}

{% block content %}
<div class="setup-container">
    <ion-card class="setup-card">
        <!-- Header -->
        <ion-card-header class="text-center">
            <img src="{% static 'img/logo.png' %}" alt="ERPlora" style="width: 48px; height: 48px; margin: 0 auto 0.5rem;">
            <ion-card-title class="text-2xl">{% trans "Welcome to ERPlora" %}</ion-card-title>
            <ion-card-subtitle>{% trans "Configure your store to get started" %}</ion-card-subtitle>
        </ion-card-header>

        <ion-card-content>
            <form hx-post="{% url 'setup:wizard' %}"
                  hx-target="#form-errors"
                  hx-swap="innerHTML"
                  hx-indicator="#submit-spinner">

                {% csrf_token %}

                <!-- Error container -->
                <div id="form-errors"></div>

                <!-- Business Information Section -->
                <h3 class="section-title">
                    <ion-icon name="business-outline"></ion-icon>
                    {% trans "Business Information" %}
                </h3>

                <ion-list>
                    <ion-item>
                        <ion-input
                            type="text"
                            name="business_name"
                            label="{% trans 'Business Name' %} *"
                            label-placement="floating"
                            value="{{ store_config.business_name }}"
                            placeholder="{% trans 'Your business name' %}"
                            required
                        ></ion-input>
                    </ion-item>

                    <ion-item>
                        <ion-textarea
                            name="business_address"
                            label="{% trans 'Address' %} *"
                            label-placement="floating"
                            value="{{ store_config.business_address }}"
                            rows="2"
                            placeholder="{% trans 'Street, City, Postal Code' %}"
                            required
                        ></ion-textarea>
                    </ion-item>

                    <ion-item>
                        <ion-input
                            type="text"
                            name="vat_number"
                            label="{% trans 'VAT/Tax ID' %} *"
                            label-placement="floating"
                            value="{{ store_config.vat_number }}"
                            placeholder="{% trans 'e.g., ES12345678A' %}"
                            required
                        ></ion-input>
                    </ion-item>

                    <ion-item>
                        <ion-input
                            type="tel"
                            name="phone"
                            label="{% trans 'Phone' %}"
                            label-placement="floating"
                            value="{{ store_config.phone }}"
                            placeholder="+34 600 000 000"
                        ></ion-input>
                    </ion-item>

                    <ion-item>
                        <ion-input
                            type="email"
                            name="email"
                            label="{% trans 'Email' %}"
                            label-placement="floating"
                            value="{{ store_config.email }}"
                            placeholder="info@business.com"
                        ></ion-input>
                    </ion-item>
                </ion-list>

                <!-- Tax Configuration Section -->
                <h3 class="section-title">
                    <ion-icon name="calculator-outline"></ion-icon>
                    {% trans "Tax Configuration" %}
                </h3>

                <ion-list>
                    <ion-item>
                        <ion-input
                            type="number"
                            name="tax_rate"
                            label="{% trans 'Default Tax Rate (%)' %}"
                            label-placement="floating"
                            value="{{ store_config.tax_rate|default:'21' }}"
                            placeholder="21"
                            min="0"
                            max="100"
                            step="0.01"
                        ></ion-input>
                    </ion-item>

                    <ion-item>
                        <ion-label>{% trans "Tax included in prices" %}</ion-label>
                        <ion-checkbox
                            slot="end"
                            name="tax_included"
                            {% if store_config.tax_included %}checked{% endif %}
                        ></ion-checkbox>
                    </ion-item>
                </ion-list>

                <p class="text-sm text-medium mt-4 text-center">* {% trans "Required fields" %}</p>

                <!-- Submit Button -->
                <div class="ion-padding-top">
                    <ion-button type="submit" expand="block" size="large">
                        <ion-spinner id="submit-spinner" name="crescent" class="htmx-indicator" style="margin-right: 8px;"></ion-spinner>
                        <ion-icon name="checkmark-circle-outline" slot="start"></ion-icon>
                        {% trans "Complete Setup" %}
                    </ion-button>
                </div>
            </form>
        </ion-card-content>
    </ion-card>
</div>
{% endblock %}
