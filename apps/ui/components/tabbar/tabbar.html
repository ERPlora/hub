{% load i18n static component_tags %}
{#
    Tab Bar Component - Renderiza tabs desde module.json

    Params:
        module_id: ID del módulo (requerido para cargar tabs de module.json)
        current_view: Vista actual para marcar tab activo
        oob: Ignorado - ahora usa JavaScript para actualizar el tabbar
        color: Color del ion-tab-bar (opcional)

    Estructura: El componente envía los tabs via JavaScript llamando a
    window.updateGlobalTabBar() definida en app_base.html.
    Esto evita problemas con HTMX OOB y Ionic Web Components.
#}

{% if render and visible_tabs %}
{# Actualizar tabbar via JavaScript #}
<script>
(function() {
    // Tabs data from Django template
    const tabs = [
        {% for tab in visible_tabs %}
        {
            url: "{% url tab.url %}",
            icon: "{{ tab.icon }}",
            label: "{{ tab.label|escapejs }}",
            active: {% if active_view == tab.id %}true{% else %}false{% endif %}
        }{% if not forloop.last %},{% endif %}
        {% endfor %}
    ];

    // Update the global tabbar
    if (typeof window.updateGlobalTabBar === 'function') {
        window.updateGlobalTabBar(tabs);
    }
})();
</script>
{% else %}
{# No tabs - clear the tabbar #}
<script>
(function() {
    if (typeof window.updateGlobalTabBar === 'function') {
        window.updateGlobalTabBar([]);
    }
})();
</script>
{% endif %}
