{# Tabbar OOB Swap - Include this AFTER the main component in partials #}
{# Usage: {% include "ui/includes/tabbar_oob.html" %} #}
{% load djicons %}
{% if render_tabbar and navigation %}
<footer id="global-tabbar-footer" class="ux-footer" hx-swap-oob="outerHTML:#global-tabbar-footer">
    <div id="global-tabbar" class="ux-tab-bar ux-tab-bar--bottom">
        {% for nav in navigation %}
        <button
            class="ux-tab-button{% if nav.id == current_view %} ux-tab-button--selected{% endif %}"
            hx-get="{{ nav.url }}"
            hx-target="#main-content-area"
            hx-push-url="true">
            {% icon nav.icon %}
            <span class="ux-tab-button__label">{{ nav.label }}</span>
        </button>
        {% endfor %}
    </div>
</footer>
<script>
document.body.setAttribute('data-module-id', '{{ module_id }}');
(function() {
    var currentPath = window.location.pathname;
    var footer = document.getElementById('global-tabbar-footer');
    if (footer) {
        footer.querySelectorAll('.ux-tab-button').forEach(function(btn) {
            var btnPath = btn.getAttribute('hx-get');
            btn.classList.remove('ux-tab-button--selected');
            if (btnPath && (currentPath === btnPath || currentPath.replace(/\/$/, '') === btnPath.replace(/\/$/, ''))) {
                btn.classList.add('ux-tab-button--selected');
            }
        });
    }
})();
</script>
{% elif render_tabbar and not navigation %}
{# HTMX to non-module page = hide tabbar #}
<footer id="global-tabbar-footer" class="ux-footer" hx-swap-oob="outerHTML:#global-tabbar-footer" style="display: none;">
    <div id="global-tabbar" class="ux-tab-bar ux-tab-bar--bottom"></div>
</footer>
<script>document.body.removeAttribute('data-module-id');</script>
{% endif %}
