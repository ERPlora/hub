{#
    Module Content Template - Base template for all module views

    This template is used by the @module_view decorator to render module pages.
    It provides:
    - Secondary header with page title and optional back button
    - Content area for module-specific content
    - Tabbar update script (conditional based on render_tabbar)

    Context variables (provided by @module_view decorator):
    - module_id: The module identifier
    - module_name: The module display name
    - navigation: List of navigation items for the tabbar
    - navigation_json: JSON-serialized navigation for JavaScript
    - current_view: The current view/tab ID
    - page_title: The page title to display
    - render_tabbar: Whether to render the tabbar update script

    Usage in module templates:
        {% extends "ui/module_content.html" %}

        {% block header_actions %}
        <button class="ux-button">
            {% icon "add-outline" %}
        </button>
        {% endblock %}

        {% block content %}
        <div class="ux-list">
            {% for item in items %}
            <div class="ux-list__item">{{ item.name }}</div>
            {% endfor %}
        </div>
        {% endblock %}
#}
{% load i18n %}

{# Page Header (secondary, inside main-content-area) #}
<div class="content-header">
    <div class="ux-toolbar">
        <div class="ux-toolbar__start">
            <button
                class="ux-button ux-button--clear"
                hx-get="/"
                hx-target="#main-content-area"
                hx-push-url="true"
                aria-label="Back">
                {% load djicons %}{% icon "chevron-back-outline" %}
            </button>
        </div>
        <h1 class="ux-toolbar__title">{{ page_title }}</h1>
        <div class="ux-toolbar__end">
            {% block header_actions %}{% endblock %}
        </div>
    </div>
</div>

{# Page Content #}
<div class="module-content">
    {% block content %}{% endblock %}
</div>

{# Tabbar Update Script (only if render_tabbar=True) #}
{% if render_tabbar and navigation %}
<script>
(function() {
    // Update tabbar with navigation items
    var tabs = {{ navigation_json|safe }};
    if (typeof window.updateGlobalTabBar === 'function') {
        window.updateGlobalTabBar(tabs);
    }

    // Store current module ID for future HTMX requests
    document.body.setAttribute('data-module-id', '{{ module_id }}');
})();
</script>
{% endif %}
