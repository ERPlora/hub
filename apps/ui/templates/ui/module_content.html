{#
    Module Content Template - Base template for all module views

    This template is used by the @module_view decorator to render module pages.
    It provides:
    - Secondary header with page title and optional back button
    - Content area for module-specific content
    - Tabbar update script (conditional based on render_tabbar)

    Context variables (provided by @module_view decorator):
    - module_id: The module identifier
    - module_name: The module display name
    - navigation: List of navigation items for the tabbar
    - navigation_json: JSON-serialized navigation for JavaScript
    - current_view: The current view/tab ID
    - page_title: The page title to display
    - render_tabbar: Whether to render the tabbar update script

    Usage in module templates:
        {% extends "ui/module_content.html" %}

        {% block header_actions %}
        <ion-button>
            <ion-icon slot="icon-only" name="add-outline"></ion-icon>
        </ion-button>
        {% endblock %}

        {% block content %}
        <ion-list>
            {% for item in items %}
            <ion-item>{{ item.name }}</ion-item>
            {% endfor %}
        </ion-list>
        {% endblock %}
#}
{% load i18n %}

{# Page Header (secondary, inside main-content-area) #}
<div class="content-header">
    <ion-toolbar>
        <ion-buttons slot="start">
            <ion-back-button
                default-href="/"
                text=""
                hx-get="/"
                hx-target="#main-content-area"
                hx-push-url="true"
                @click.prevent
            ></ion-back-button>
        </ion-buttons>
        <ion-title>{{ page_title }}</ion-title>
        <ion-buttons slot="end">
            {% block header_actions %}{% endblock %}
        </ion-buttons>
    </ion-toolbar>
</div>

{# Page Content #}
<div class="module-content">
    {% block content %}{% endblock %}
</div>

{# Tabbar Update Script (only if render_tabbar=True) #}
{% if render_tabbar and navigation %}
<script>
(function() {
    // Update tabbar with navigation items
    var tabs = {{ navigation_json|safe }};
    if (typeof window.updateGlobalTabBar === 'function') {
        window.updateGlobalTabBar(tabs);
    }

    // Store current module ID for future HTMX requests
    document.body.setAttribute('data-module-id', '{{ module_id }}');
})();
</script>
{% endif %}
