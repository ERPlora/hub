{% load i18n %}

{# Server-rendered stepper progress bar #}
{# Context: current_step (1-3), completed_steps (set), step_labels (list) #}

<div class="stepper-header">
    <div class="stepper-progress" style="width: {{ progress_width }}%;"></div>

    {% for label in step_labels %}
    {% with step_num=forloop.counter %}
    <div class="stepper-step
        {% if step_num in completed_steps %}stepper-step--completed{% endif %}
        {% if step_num == current_step %}stepper-step--current{% endif %}
        {% if step_num <= current_step %}stepper-step--active{% endif %}"
        {% if step_num in completed_steps or step_num < current_step %}
        hx-get="{% url 'setup:step' step=step_num %}"
        hx-target="#wizard-step-content"
        hx-swap="innerHTML"
        style="cursor: pointer;"
        {% endif %}>
        <div class="stepper-circle">
            {% if step_num in completed_steps %}
            <svg class="stepper-check" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                <polyline points="20 6 9 17 4 12"/>
            </svg>
            {% else %}
            <span>{{ step_num }}</span>
            {% endif %}
        </div>
        <span class="stepper-label">{{ label }}</span>
    </div>
    {% endwith %}
    {% endfor %}
</div>
