{% load i18n djicons %}

{% include "setup/partials/stepper.html" %}

{% if errors %}
<div class="callout callout-warning mb-4">
    {% for error in errors %}
    <p>{% icon "alert-circle-outline" %} {{ error }}</p>
    {% endfor %}
</div>
{% endif %}

<div class="stepper-content">
    <h2 class="text-xl font-semibold mb-1">{% trans "Business Information" %}</h2>
    <p class="text-sm opacity-60 mb-6">{% trans "Tell us about your business" %}</p>

    <form hx-post="{% url 'setup:step' step=3 %}"
          hx-target="#wizard-step-content"
          hx-swap="innerHTML">
        {% csrf_token %}

        <div class="flex flex-col gap-4">
            <div class="form-group">
                <label class="form-group-label form-group-label-required" for="business_name">{% trans "Business Name" %}</label>
                <input class="input"
                    type="text"
                    name="business_name"
                    id="business_name"
                    value="{{ store_config.business_name }}"
                    placeholder="{% trans 'Your business name' %}"
                    required>
            </div>
            <div class="form-group">
                <label class="form-group-label form-group-label-required" for="business_address">{% trans "Address" %}</label>
                <textarea class="textarea"
                    name="business_address"
                    id="business_address"
                    rows="2"
                    placeholder="{% trans 'Street, City, Postal Code' %}"
                    required>{{ store_config.business_address }}</textarea>
            </div>
            <div class="form-group">
                <label class="form-group-label form-group-label-required" for="vat_number">{% trans "VAT/Tax ID" %}</label>
                <input class="input"
                    type="text"
                    name="vat_number"
                    id="vat_number"
                    value="{{ store_config.vat_number }}"
                    placeholder="{% trans 'e.g., ES12345678A' %}"
                    required>
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label class="form-group-label">{% trans "Phone" %}</label>
                    <div class="phone-input"
                         x-data="phoneInput()"
                         :class="{ 'phone-input-open': open }"
                         @click.outside="open = false"
                         @keydown.escape="open = false">
                        <input type="hidden" name="phone" :value="fullNumber">
                        <button type="button"
                                class="phone-input-country"
                                @click="toggle()">
                            <span class="phone-input-flag" x-text="selectedCountry.flag"></span>
                            <span class="phone-input-code" x-text="selectedCountry.dial"></span>
                            <svg class="phone-input-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
                        </button>
                        <input type="tel"
                               class="input"
                               x-model="number"
                               placeholder="600 000 000">
                        <div class="phone-input-dropdown">
                            <div class="phone-input-search">
                                <input type="text"
                                       class="phone-input-search-input"
                                       x-model="search"
                                       @input="highlighted = 0"
                                       placeholder="{% trans 'Search country...' %}"
                                       x-ref="searchInput">
                            </div>
                            <div class="phone-input-list">
                                <template x-for="(c, i) in filteredCountries" :key="c.code">
                                    <div class="phone-input-option"
                                         :class="{ 'phone-input-option-selected': c.code === selectedCountry.code }"
                                         @click="selectCountry(c)">
                                        <span class="phone-input-option-flag" x-text="c.flag"></span>
                                        <span class="phone-input-option-name" x-text="c.name"></span>
                                        <span class="phone-input-option-code" x-text="c.dial"></span>
                                    </div>
                                </template>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-group-label" for="email">{% trans "Email" %}</label>
                    <input class="input"
                        type="email"
                        name="email"
                        id="email"
                        value="{{ store_config.email }}"
                        placeholder="info@business.com">
                </div>
            </div>
        </div>

        <div class="stepper-actions">
            <div class="stepper-actions-start">
                <button type="button"
                        class="btn btn-outline"
                        hx-get="{% url 'setup:step' step=2 %}"
                        hx-target="#wizard-step-content"
                        hx-swap="innerHTML">
                    {% icon "arrow-back-outline" %}
                    {% trans "Back" %}
                </button>
            </div>
            <div class="stepper-actions-end">
                <button type="submit" class="btn color-primary">
                    {% trans "Continue" %}
                    {% icon "arrow-forward-outline" %}
                </button>
            </div>
        </div>
    </form>
</div>
